
(defpackage :foo
  (:use :cl))
(in-package :foo)

(declaim (optimize (speed 0)(debug 3)(space 0)))
(sb-ext:restrict-compiler-policy 'debug 3 3)
(sb-ext:restrict-compiler-policy 'space 0 0)
(sb-ext:restrict-compiler-policy 'speed 0 0)

;; FORMAT 
;; (width height) (explorer-x explorer-y) (wind-x wind-y wind-dir) ... other winds ...

(defparameter *example1*
  '((5 5) (1 0) (4 4 v) (1 2 >)))

(defparameter *example2* 
  '((6 4) (1 0) (6 4 >) (5 4 ^) (4 4 ^) (3 4 v) (2 4 ^) (1 4 <) (6 3 >) (5 3 <)
    (4 3 >) (2 3 v) (1 3 >) (6 2 <) (5 2 <) (2 2 <) (6 1 <) (5 1 ^) (4 1 <)
    (2 1 >) (1 1 >)))

(defparameter *input*
  '((120 25) (1 0) (120 25 >) (119 25 v) (118 25 v) (117 25 >) (116 25 ^)
    (115 25 v) (114 25 ^) (113 25 v) (112 25 >) (110 25 ^) (109 25 ^) (108 25 ^)
    (107 25 >) (106 25 >) (105 25 <) (104 25 >) (103 25 >) (99 25 ^) (98 25 ^)
    (97 25 ^) (96 25 v) (95 25 <) (94 25 ^) (92 25 v) (91 25 <) (90 25 ^)
    (89 25 >) (88 25 <) (87 25 v) (86 25 <) (85 25 >) (83 25 <) (82 25 <)
    (81 25 >) (80 25 <) (79 25 <) (78 25 ^) (77 25 >) (76 25 <) (75 25 v)
    (74 25 ^) (73 25 ^) (71 25 <) (70 25 <) (69 25 >) (68 25 <) (67 25 <)
    (66 25 v) (65 25 ^) (64 25 >) (63 25 <) (62 25 >) (61 25 >) (60 25 <)
    (57 25 <) (56 25 v) (55 25 v) (53 25 v) (52 25 <) (51 25 >) (50 25 ^)
    (49 25 ^) (48 25 >) (47 25 <) (46 25 v) (45 25 <) (44 25 ^) (43 25 v)
    (42 25 <) (41 25 v) (39 25 <) (38 25 ^) (37 25 <) (36 25 >) (35 25 v)
    (34 25 ^) (33 25 >) (32 25 <) (31 25 v) (30 25 <) (29 25 >) (27 25 ^)
    (26 25 >) (25 25 v) (24 25 <) (23 25 <) (22 25 v) (21 25 >) (20 25 ^)
    (19 25 ^) (18 25 >) (17 25 ^) (16 25 <) (15 25 >) (14 25 >) (13 25 >)
    (12 25 <) (11 25 <) (10 25 <) (9 25 v) (8 25 v) (7 25 v) (6 25 >) (5 25 >)
    (4 25 >) (3 25 v) (2 25 <) (1 25 >) (120 24 <) (117 24 v) (116 24 >)
    (115 24 ^) (114 24 v) (113 24 v) (112 24 <) (111 24 <) (110 24 v) (109 24 <)
    (108 24 >) (107 24 ^) (106 24 >) (104 24 v) (101 24 >) (100 24 >) (99 24 <)
    (98 24 ^) (97 24 ^) (96 24 v) (95 24 v) (94 24 >) (93 24 v) (92 24 v)
    (91 24 ^) (90 24 <) (89 24 ^) (88 24 <) (87 24 v) (86 24 <) (85 24 v)
    (84 24 >) (82 24 v) (81 24 ^) (80 24 >) (79 24 ^) (78 24 >) (77 24 <)
    (76 24 <) (75 24 <) (73 24 >) (71 24 v) (70 24 v) (69 24 >) (68 24 ^)
    (67 24 v) (66 24 v) (64 24 v) (63 24 >) (62 24 v) (61 24 ^) (60 24 v)
    (58 24 <) (57 24 ^) (56 24 <) (55 24 v) (54 24 ^) (53 24 v) (52 24 <)
    (51 24 <) (50 24 ^) (49 24 v) (48 24 v) (47 24 ^) (46 24 v) (45 24 >)
    (44 24 >) (42 24 v) (41 24 >) (40 24 v) (39 24 <) (38 24 v) (37 24 ^)
    (36 24 <) (35 24 <) (34 24 v) (33 24 v) (32 24 >) (31 24 <) (30 24 v)
    (29 24 ^) (28 24 >) (27 24 >) (26 24 >) (25 24 ^) (24 24 <) (23 24 >)
    (22 24 ^) (21 24 ^) (19 24 ^) (18 24 >) (17 24 ^) (16 24 ^) (15 24 ^)
    (14 24 v) (13 24 <) (12 24 ^) (11 24 >) (10 24 <) (9 24 <) (8 24 >) (6 24 >)
    (5 24 <) (4 24 v) (3 24 v) (2 24 <) (1 24 >) (120 23 <) (119 23 >) (118 23 v)
    (115 23 v) (114 23 >) (113 23 ^) (112 23 ^) (111 23 ^) (110 23 <) (109 23 ^)
    (108 23 v) (107 23 <) (106 23 >) (105 23 >) (103 23 >) (102 23 >) (101 23 ^)
    (100 23 ^) (99 23 >) (98 23 >) (97 23 >) (96 23 v) (95 23 <) (93 23 >)
    (92 23 <) (91 23 <) (90 23 >) (89 23 v) (88 23 >) (87 23 >) (86 23 ^)
    (85 23 <) (84 23 <) (83 23 <) (82 23 >) (81 23 <) (80 23 >) (79 23 v)
    (78 23 ^) (77 23 <) (76 23 v) (75 23 v) (74 23 v) (73 23 >) (72 23 <)
    (71 23 ^) (70 23 ^) (69 23 <) (68 23 <) (67 23 ^) (66 23 ^) (65 23 v)
    (63 23 ^) (62 23 >) (61 23 <) (59 23 v) (58 23 <) (56 23 >) (55 23 >)
    (54 23 <) (51 23 <) (50 23 >) (49 23 <) (48 23 <) (47 23 <) (46 23 ^)
    (45 23 >) (44 23 <) (43 23 v) (42 23 >) (41 23 ^) (40 23 >) (38 23 ^)
    (37 23 >) (36 23 >) (35 23 ^) (34 23 >) (32 23 >) (31 23 v) (30 23 v)
    (29 23 v) (28 23 <) (27 23 >) (26 23 ^) (25 23 <) (24 23 ^) (23 23 >)
    (22 23 <) (21 23 v) (20 23 <) (19 23 >) (18 23 <) (17 23 v) (16 23 <)
    (15 23 v) (14 23 >) (13 23 >) (12 23 <) (11 23 <) (10 23 >) (9 23 ^) (8 23 v)
    (7 23 v) (6 23 ^) (5 23 <) (4 23 >) (2 23 >) (1 23 >) (120 22 >) (119 22 >)
    (118 22 ^) (117 22 v) (116 22 ^) (114 22 ^) (113 22 ^) (111 22 >) (110 22 >)
    (109 22 ^) (108 22 >) (107 22 v) (106 22 ^) (105 22 ^) (104 22 <) (103 22 ^)
    (102 22 >) (100 22 <) (99 22 >) (98 22 v) (97 22 <) (95 22 ^) (93 22 <)
    (92 22 v) (91 22 >) (90 22 <) (89 22 <) (88 22 v) (86 22 <) (85 22 ^)
    (84 22 >) (83 22 ^) (82 22 ^) (81 22 >) (80 22 >) (79 22 ^) (78 22 ^)
    (77 22 <) (76 22 ^) (75 22 <) (74 22 v) (73 22 <) (72 22 <) (71 22 <)
    (70 22 ^) (69 22 <) (68 22 ^) (67 22 <) (66 22 ^) (65 22 <) (64 22 ^)
    (63 22 >) (62 22 v) (61 22 ^) (60 22 ^) (59 22 >) (57 22 ^) (56 22 ^)
    (55 22 v) (54 22 >) (53 22 <) (52 22 v) (51 22 ^) (49 22 v) (48 22 >)
    (47 22 >) (46 22 <) (45 22 ^) (44 22 >) (43 22 <) (42 22 ^) (40 22 v)
    (39 22 ^) (38 22 v) (37 22 v) (36 22 ^) (35 22 ^) (34 22 <) (32 22 >)
    (31 22 >) (30 22 v) (29 22 >) (27 22 ^) (26 22 <) (25 22 ^) (24 22 >)
    (23 22 ^) (22 22 <) (21 22 ^) (20 22 v) (19 22 <) (18 22 v) (17 22 v)
    (16 22 v) (15 22 v) (14 22 v) (12 22 <) (11 22 ^) (9 22 v) (8 22 >) (7 22 <)
    (6 22 <) (5 22 ^) (4 22 >) (3 22 <) (2 22 >) (1 22 <) (120 21 >) (118 21 <)
    (117 21 ^) (116 21 ^) (115 21 v) (114 21 <) (112 21 >) (111 21 v) (110 21 <)
    (109 21 >) (108 21 <) (107 21 >) (106 21 <) (104 21 v) (103 21 v) (102 21 v)
    (101 21 <) (100 21 ^) (99 21 >) (98 21 <) (97 21 >) (96 21 <) (95 21 <)
    (94 21 v) (93 21 ^) (92 21 <) (91 21 <) (90 21 >) (89 21 v) (87 21 v)
    (86 21 <) (85 21 v) (84 21 <) (83 21 v) (82 21 <) (81 21 >) (79 21 ^)
    (77 21 v) (76 21 ^) (75 21 v) (74 21 v) (73 21 v) (72 21 <) (71 21 <)
    (70 21 v) (69 21 ^) (67 21 <) (66 21 v) (65 21 <) (64 21 v) (63 21 ^)
    (62 21 >) (61 21 ^) (60 21 >) (59 21 ^) (58 21 >) (57 21 <) (56 21 ^)
    (55 21 v) (54 21 <) (53 21 ^) (51 21 ^) (50 21 >) (49 21 ^) (48 21 ^)
    (47 21 >) (45 21 <) (44 21 <) (42 21 >) (41 21 v) (40 21 v) (39 21 <)
    (38 21 >) (37 21 v) (35 21 >) (34 21 <) (33 21 ^) (32 21 <) (31 21 <)
    (27 21 <) (26 21 <) (25 21 <) (24 21 v) (23 21 >) (21 21 <) (20 21 <)
    (19 21 ^) (18 21 v) (17 21 ^) (15 21 >) (14 21 >) (13 21 <) (12 21 >)
    (11 21 ^) (9 21 v) (8 21 <) (7 21 >) (6 21 >) (5 21 >) (4 21 ^) (3 21 ^)
    (2 21 <) (1 21 >) (119 20 v) (118 20 >) (117 20 v) (116 20 <) (115 20 ^)
    (114 20 ^) (113 20 ^) (112 20 v) (111 20 ^) (110 20 >) (109 20 <) (108 20 v)
    (107 20 <) (106 20 <) (105 20 v) (104 20 <) (102 20 >) (101 20 <) (100 20 ^)
    (98 20 >) (97 20 v) (96 20 >) (95 20 >) (94 20 <) (93 20 ^) (92 20 >)
    (91 20 ^) (90 20 ^) (89 20 ^) (87 20 <) (86 20 >) (85 20 v) (84 20 <)
    (83 20 v) (82 20 <) (81 20 <) (80 20 v) (79 20 v) (78 20 v) (77 20 v)
    (76 20 ^) (75 20 >) (74 20 >) (73 20 <) (72 20 >) (71 20 <) (70 20 <)
    (69 20 ^) (68 20 v) (67 20 v) (66 20 ^) (65 20 >) (64 20 v) (63 20 >)
    (62 20 >) (61 20 ^) (60 20 >) (59 20 <) (58 20 >) (57 20 ^) (56 20 ^)
    (55 20 ^) (54 20 <) (53 20 v) (52 20 v) (50 20 v) (49 20 <) (48 20 <)
    (47 20 ^) (45 20 >) (44 20 <) (43 20 <) (42 20 v) (41 20 ^) (40 20 <)
    (39 20 ^) (38 20 >) (37 20 v) (36 20 v) (35 20 <) (34 20 >) (33 20 v)
    (32 20 <) (31 20 ^) (30 20 v) (29 20 v) (28 20 v) (27 20 >) (25 20 v)
    (24 20 ^) (23 20 >) (22 20 >) (21 20 <) (20 20 <) (19 20 >) (18 20 <)
    (17 20 ^) (16 20 v) (14 20 >) (13 20 >) (12 20 v) (10 20 v) (9 20 <) (7 20 <)
    (6 20 ^) (5 20 <) (4 20 <) (3 20 >) (2 20 >) (1 20 >) (120 19 >) (119 19 >)
    (118 19 >) (117 19 ^) (116 19 >) (115 19 v) (114 19 <) (113 19 >) (112 19 <)
    (111 19 ^) (110 19 ^) (109 19 ^) (108 19 v) (107 19 >) (106 19 >) (105 19 ^)
    (104 19 v) (103 19 ^) (102 19 v) (101 19 >) (100 19 >) (99 19 v) (98 19 v)
    (97 19 v) (96 19 ^) (95 19 >) (94 19 ^) (93 19 >) (92 19 v) (91 19 ^)
    (90 19 v) (89 19 <) (88 19 v) (87 19 ^) (86 19 ^) (85 19 v) (84 19 ^)
    (83 19 >) (82 19 >) (81 19 >) (79 19 >) (78 19 ^) (77 19 ^) (76 19 ^)
    (75 19 <) (74 19 >) (73 19 <) (72 19 v) (71 19 v) (70 19 <) (69 19 v)
    (68 19 >) (67 19 <) (65 19 ^) (64 19 v) (63 19 v) (62 19 >) (61 19 ^)
    (59 19 v) (58 19 <) (57 19 <) (56 19 <) (54 19 v) (53 19 >) (52 19 ^)
    (51 19 >) (49 19 >) (48 19 ^) (47 19 v) (46 19 >) (45 19 >) (44 19 >)
    (43 19 v) (42 19 >) (41 19 ^) (40 19 >) (39 19 >) (38 19 ^) (37 19 <)
    (36 19 v) (35 19 <) (33 19 v) (32 19 ^) (31 19 >) (30 19 v) (29 19 v)
    (28 19 <) (27 19 v) (26 19 v) (25 19 <) (24 19 v) (23 19 ^) (22 19 <)
    (21 19 v) (20 19 ^) (19 19 v) (18 19 v) (17 19 ^) (16 19 v) (15 19 >)
    (14 19 ^) (13 19 >) (12 19 >) (11 19 <) (9 19 >) (8 19 v) (7 19 v) (6 19 <)
    (5 19 <) (4 19 v) (3 19 v) (2 19 ^) (1 19 <) (120 18 >) (119 18 ^) (118 18 >)
    (117 18 >) (116 18 >) (115 18 v) (114 18 v) (113 18 <) (112 18 v) (111 18 v)
    (110 18 >) (109 18 >) (108 18 v) (107 18 <) (106 18 >) (105 18 v) (104 18 ^)
    (103 18 ^) (102 18 <) (101 18 v) (100 18 <) (99 18 ^) (98 18 <) (97 18 >)
    (96 18 <) (95 18 <) (94 18 <) (93 18 ^) (92 18 ^) (91 18 v) (90 18 ^)
    (89 18 v) (88 18 ^) (87 18 <) (86 18 v) (85 18 >) (84 18 ^) (83 18 ^)
    (81 18 ^) (80 18 ^) (79 18 ^) (78 18 >) (77 18 v) (76 18 >) (75 18 ^)
    (74 18 <) (73 18 ^) (72 18 >) (71 18 v) (70 18 ^) (69 18 v) (68 18 <)
    (67 18 v) (66 18 v) (65 18 v) (63 18 <) (62 18 <) (61 18 >) (60 18 >)
    (59 18 >) (58 18 >) (57 18 ^) (56 18 <) (55 18 ^) (54 18 v) (53 18 >)
    (52 18 >) (51 18 <) (50 18 <) (49 18 >) (48 18 v) (47 18 v) (45 18 ^)
    (44 18 v) (43 18 <) (42 18 <) (41 18 v) (40 18 <) (39 18 <) (38 18 <)
    (37 18 >) (36 18 >) (35 18 ^) (34 18 ^) (33 18 >) (32 18 ^) (31 18 ^)
    (30 18 v) (29 18 <) (28 18 v) (27 18 ^) (26 18 <) (25 18 <) (24 18 v)
    (23 18 v) (21 18 v) (20 18 <) (19 18 ^) (18 18 >) (17 18 v) (16 18 <)
    (15 18 v) (14 18 ^) (13 18 <) (11 18 ^) (10 18 >) (9 18 v) (8 18 v) (7 18 ^)
    (6 18 <) (5 18 v) (4 18 ^) (3 18 >) (2 18 <) (1 18 >) (120 17 >) (119 17 ^)
    (118 17 ^) (117 17 >) (115 17 <) (114 17 v) (113 17 v) (112 17 <) (111 17 v)
    (110 17 >) (109 17 v) (108 17 v) (107 17 ^) (105 17 <) (104 17 ^) (103 17 ^)
    (102 17 v) (101 17 v) (100 17 >) (98 17 <) (96 17 v) (95 17 ^) (94 17 v)
    (93 17 <) (92 17 <) (91 17 ^) (90 17 >) (88 17 ^) (87 17 <) (86 17 ^)
    (85 17 ^) (84 17 >) (82 17 <) (81 17 ^) (80 17 >) (79 17 ^) (77 17 v)
    (76 17 >) (75 17 <) (73 17 >) (72 17 v) (71 17 >) (70 17 <) (69 17 ^)
    (68 17 <) (67 17 >) (66 17 >) (65 17 v) (64 17 v) (63 17 >) (62 17 <)
    (61 17 ^) (60 17 <) (58 17 >) (57 17 v) (56 17 <) (55 17 <) (54 17 v)
    (53 17 v) (52 17 v) (51 17 v) (50 17 v) (49 17 ^) (48 17 ^) (47 17 v)
    (46 17 >) (45 17 >) (44 17 ^) (43 17 ^) (42 17 v) (41 17 v) (40 17 v)
    (37 17 ^) (36 17 v) (35 17 ^) (34 17 v) (33 17 v) (31 17 >) (29 17 v)
    (28 17 ^) (27 17 <) (25 17 >) (24 17 v) (23 17 v) (22 17 >) (21 17 ^)
    (20 17 ^) (19 17 >) (18 17 >) (17 17 v) (16 17 v) (15 17 v) (14 17 v)
    (12 17 >) (11 17 ^) (10 17 ^) (9 17 v) (7 17 v) (6 17 <) (5 17 <) (4 17 >)
    (3 17 <) (2 17 <) (1 17 >) (120 16 >) (119 16 <) (118 16 ^) (117 16 ^)
    (116 16 v) (115 16 >) (114 16 >) (113 16 v) (112 16 ^) (111 16 >) (110 16 v)
    (109 16 ^) (108 16 ^) (107 16 ^) (106 16 v) (105 16 <) (104 16 >) (102 16 >)
    (101 16 v) (100 16 >) (99 16 ^) (98 16 v) (97 16 <) (96 16 v) (95 16 ^)
    (94 16 >) (93 16 ^) (92 16 >) (91 16 <) (90 16 ^) (89 16 v) (88 16 >)
    (86 16 v) (85 16 v) (84 16 v) (83 16 ^) (82 16 ^) (81 16 <) (80 16 ^)
    (79 16 >) (78 16 >) (77 16 >) (75 16 <) (74 16 ^) (73 16 ^) (72 16 <)
    (71 16 v) (70 16 <) (69 16 v) (68 16 >) (67 16 <) (66 16 >) (65 16 >)
    (64 16 v) (63 16 ^) (62 16 v) (61 16 ^) (60 16 v) (58 16 ^) (57 16 <)
    (56 16 >) (55 16 v) (54 16 <) (53 16 >) (52 16 >) (51 16 <) (50 16 <)
    (49 16 v) (48 16 >) (47 16 >) (46 16 >) (45 16 v) (44 16 >) (43 16 v)
    (42 16 <) (41 16 <) (39 16 >) (38 16 >) (37 16 ^) (36 16 ^) (35 16 >)
    (33 16 ^) (32 16 >) (31 16 ^) (30 16 ^) (29 16 ^) (28 16 ^) (27 16 >)
    (26 16 >) (25 16 >) (24 16 <) (23 16 >) (22 16 ^) (21 16 <) (20 16 >)
    (19 16 <) (18 16 v) (17 16 <) (16 16 v) (15 16 >) (14 16 >) (13 16 ^)
    (12 16 ^) (11 16 ^) (10 16 ^) (9 16 >) (7 16 >) (6 16 ^) (5 16 ^) (4 16 >)
    (3 16 <) (2 16 >) (1 16 >) (120 15 <) (119 15 >) (116 15 <) (115 15 >)
    (113 15 >) (112 15 >) (110 15 >) (109 15 <) (108 15 >) (107 15 ^) (105 15 ^)
    (104 15 ^) (103 15 v) (102 15 v) (101 15 v) (100 15 v) (99 15 v) (98 15 v)
    (97 15 ^) (96 15 >) (95 15 v) (94 15 >) (92 15 <) (91 15 v) (90 15 <)
    (89 15 <) (88 15 ^) (87 15 >) (86 15 ^) (85 15 <) (84 15 v) (83 15 v)
    (82 15 v) (81 15 ^) (80 15 >) (79 15 <) (77 15 <) (76 15 <) (74 15 <)
    (73 15 <) (72 15 >) (71 15 ^) (70 15 >) (68 15 ^) (67 15 v) (65 15 ^)
    (64 15 <) (63 15 >) (62 15 ^) (61 15 ^) (60 15 <) (59 15 v) (58 15 v)
    (57 15 ^) (56 15 ^) (55 15 ^) (53 15 ^) (52 15 >) (51 15 >) (50 15 >)
    (49 15 v) (48 15 <) (47 15 >) (46 15 ^) (45 15 ^) (44 15 v) (43 15 ^)
    (42 15 <) (41 15 <) (40 15 <) (39 15 ^) (37 15 v) (36 15 >) (35 15 v)
    (34 15 >) (33 15 <) (32 15 v) (31 15 <) (30 15 <) (29 15 v) (28 15 ^)
    (27 15 ^) (24 15 <) (23 15 >) (22 15 >) (21 15 <) (20 15 <) (19 15 ^)
    (18 15 <) (17 15 ^) (16 15 ^) (15 15 v) (14 15 ^) (13 15 <) (12 15 v)
    (11 15 v) (10 15 v) (9 15 <) (8 15 v) (7 15 ^) (6 15 v) (5 15 <) (4 15 ^)
    (3 15 >) (2 15 ^) (1 15 >) (120 14 <) (118 14 >) (117 14 >) (116 14 v)
    (115 14 >) (114 14 v) (113 14 v) (112 14 <) (111 14 >) (109 14 v) (108 14 <)
    (107 14 ^) (104 14 ^) (103 14 v) (102 14 v) (100 14 v) (99 14 >) (98 14 >)
    (97 14 ^) (96 14 v) (95 14 v) (94 14 v) (93 14 <) (91 14 <) (90 14 >)
    (89 14 >) (88 14 >) (87 14 >) (86 14 <) (85 14 >) (84 14 >) (83 14 ^)
    (82 14 v) (81 14 v) (80 14 ^) (79 14 ^) (78 14 ^) (77 14 ^) (76 14 <)
    (75 14 <) (74 14 >) (73 14 ^) (72 14 <) (71 14 ^) (70 14 >) (69 14 ^)
    (68 14 >) (67 14 <) (66 14 <) (65 14 v) (64 14 ^) (63 14 ^) (62 14 >)
    (61 14 ^) (60 14 ^) (58 14 ^) (57 14 <) (55 14 >) (54 14 >) (53 14 >)
    (51 14 v) (50 14 v) (49 14 v) (48 14 <) (47 14 <) (46 14 <) (45 14 ^)
    (43 14 <) (42 14 >) (41 14 v) (40 14 ^) (39 14 >) (38 14 <) (37 14 ^)
    (36 14 <) (35 14 <) (34 14 >) (33 14 <) (32 14 v) (31 14 <) (30 14 >)
    (29 14 v) (28 14 v) (27 14 >) (26 14 ^) (25 14 >) (24 14 ^) (22 14 >)
    (21 14 >) (20 14 v) (19 14 >) (18 14 <) (17 14 <) (16 14 ^) (15 14 v)
    (14 14 ^) (13 14 ^) (12 14 >) (11 14 v) (9 14 <) (8 14 v) (7 14 <) (5 14 >)
    (4 14 v) (3 14 ^) (2 14 ^) (1 14 >) (120 13 <) (119 13 ^) (118 13 <)
    (117 13 v) (116 13 ^) (115 13 v) (114 13 <) (113 13 ^) (112 13 v) (111 13 >)
    (110 13 >) (108 13 ^) (107 13 >) (106 13 <) (105 13 v) (104 13 >) (103 13 v)
    (101 13 <) (100 13 ^) (99 13 v) (98 13 <) (97 13 >) (96 13 ^) (95 13 ^)
    (94 13 >) (93 13 <) (92 13 <) (91 13 <) (90 13 v) (89 13 >) (88 13 <)
    (87 13 >) (86 13 <) (85 13 >) (84 13 >) (83 13 <) (82 13 <) (81 13 <)
    (80 13 >) (79 13 v) (77 13 v) (75 13 v) (74 13 v) (73 13 v) (72 13 <)
    (71 13 >) (70 13 <) (68 13 ^) (67 13 >) (66 13 ^) (65 13 ^) (64 13 v)
    (63 13 <) (62 13 ^) (61 13 ^) (59 13 ^) (58 13 v) (57 13 ^) (56 13 v)
    (55 13 >) (54 13 ^) (53 13 <) (52 13 ^) (51 13 >) (50 13 ^) (49 13 v)
    (48 13 ^) (47 13 ^) (46 13 >) (45 13 >) (44 13 v) (43 13 v) (41 13 >)
    (40 13 >) (39 13 >) (38 13 <) (37 13 >) (36 13 >) (35 13 >) (34 13 >)
    (33 13 <) (32 13 <) (31 13 ^) (30 13 >) (29 13 <) (28 13 <) (27 13 v)
    (26 13 v) (25 13 >) (23 13 v) (22 13 ^) (21 13 >) (20 13 <) (19 13 v)
    (18 13 ^) (17 13 ^) (16 13 <) (15 13 v) (14 13 v) (13 13 v) (12 13 v)
    (11 13 v) (10 13 >) (9 13 <) (8 13 <) (7 13 <) (6 13 >) (5 13 ^) (4 13 ^)
    (3 13 <) (2 13 v) (1 13 <) (120 12 >) (119 12 <) (118 12 <) (116 12 v)
    (115 12 <) (114 12 v) (112 12 ^) (111 12 >) (110 12 ^) (109 12 <) (108 12 <)
    (107 12 v) (106 12 ^) (105 12 v) (104 12 <) (103 12 <) (102 12 >) (101 12 >)
    (99 12 >) (98 12 <) (97 12 v) (96 12 <) (95 12 ^) (93 12 >) (92 12 ^)
    (91 12 v) (89 12 >) (88 12 >) (87 12 v) (86 12 v) (85 12 ^) (84 12 >)
    (83 12 v) (82 12 >) (81 12 <) (80 12 ^) (79 12 ^) (78 12 ^) (77 12 <)
    (76 12 >) (75 12 <) (74 12 v) (73 12 ^) (72 12 v) (71 12 <) (70 12 <)
    (68 12 <) (67 12 ^) (66 12 ^) (65 12 ^) (64 12 v) (63 12 v) (62 12 ^)
    (61 12 ^) (60 12 <) (59 12 >) (58 12 ^) (57 12 ^) (56 12 ^) (55 12 >)
    (54 12 ^) (53 12 v) (52 12 ^) (51 12 >) (50 12 ^) (49 12 >) (48 12 v)
    (47 12 ^) (45 12 <) (44 12 <) (43 12 v) (42 12 >) (41 12 <) (40 12 >)
    (39 12 v) (38 12 v) (37 12 v) (36 12 <) (35 12 <) (34 12 ^) (33 12 v)
    (32 12 >) (31 12 <) (30 12 >) (29 12 <) (28 12 >) (27 12 ^) (26 12 ^)
    (25 12 ^) (24 12 <) (23 12 >) (22 12 >) (21 12 >) (19 12 v) (18 12 ^)
    (17 12 <) (15 12 >) (14 12 >) (13 12 ^) (11 12 ^) (10 12 >) (9 12 >) (8 12 v)
    (7 12 >) (6 12 >) (5 12 ^) (4 12 v) (3 12 <) (2 12 >) (1 12 <) (120 11 >)
    (119 11 v) (118 11 ^) (117 11 <) (116 11 v) (115 11 ^) (114 11 >) (113 11 ^)
    (112 11 ^) (111 11 >) (110 11 <) (109 11 ^) (108 11 >) (107 11 >) (106 11 v)
    (105 11 >) (103 11 >) (102 11 <) (101 11 <) (100 11 <) (99 11 ^) (98 11 <)
    (97 11 >) (96 11 ^) (95 11 v) (94 11 ^) (93 11 >) (92 11 v) (91 11 v)
    (90 11 >) (89 11 >) (88 11 >) (87 11 <) (86 11 v) (85 11 >) (84 11 ^)
    (82 11 >) (81 11 ^) (80 11 <) (79 11 ^) (77 11 <) (76 11 <) (75 11 >)
    (74 11 <) (73 11 ^) (72 11 <) (71 11 v) (70 11 v) (69 11 <) (68 11 >)
    (66 11 ^) (65 11 ^) (64 11 v) (63 11 <) (62 11 <) (61 11 ^) (59 11 ^)
    (58 11 ^) (57 11 >) (56 11 <) (55 11 ^) (54 11 >) (53 11 <) (52 11 >)
    (51 11 ^) (50 11 >) (49 11 <) (48 11 ^) (47 11 <) (46 11 <) (45 11 v)
    (44 11 ^) (42 11 >) (41 11 ^) (40 11 >) (39 11 <) (37 11 >) (36 11 ^)
    (35 11 <) (34 11 v) (33 11 >) (32 11 ^) (31 11 ^) (30 11 ^) (28 11 ^)
    (27 11 ^) (26 11 <) (25 11 <) (23 11 v) (22 11 >) (21 11 >) (20 11 v)
    (19 11 ^) (18 11 v) (16 11 v) (15 11 <) (14 11 <) (13 11 <) (12 11 v)
    (11 11 ^) (10 11 v) (9 11 v) (8 11 ^) (7 11 ^) (6 11 ^) (5 11 >) (4 11 >)
    (3 11 >) (2 11 >) (1 11 <) (120 10 <) (119 10 v) (118 10 v) (117 10 v)
    (115 10 <) (113 10 >) (112 10 <) (111 10 ^) (110 10 >) (109 10 v) (108 10 <)
    (107 10 <) (105 10 <) (104 10 ^) (102 10 v) (101 10 >) (100 10 ^) (99 10 <)
    (98 10 <) (97 10 v) (94 10 <) (93 10 >) (92 10 >) (90 10 >) (88 10 ^)
    (87 10 ^) (86 10 v) (85 10 ^) (84 10 ^) (83 10 v) (81 10 <) (80 10 ^)
    (79 10 v) (78 10 v) (77 10 <) (76 10 >) (74 10 <) (73 10 <) (72 10 <)
    (71 10 ^) (70 10 >) (69 10 v) (68 10 ^) (67 10 v) (66 10 ^) (65 10 v)
    (64 10 v) (63 10 <) (62 10 ^) (60 10 v) (59 10 >) (58 10 <) (57 10 >)
    (56 10 <) (55 10 v) (54 10 v) (52 10 v) (51 10 v) (50 10 <) (48 10 ^)
    (47 10 ^) (46 10 v) (45 10 ^) (44 10 <) (43 10 <) (42 10 ^) (41 10 ^)
    (40 10 <) (39 10 >) (38 10 ^) (37 10 ^) (36 10 >) (35 10 >) (34 10 <)
    (33 10 <) (32 10 >) (31 10 ^) (30 10 ^) (29 10 ^) (28 10 <) (27 10 >)
    (26 10 <) (25 10 <) (24 10 >) (23 10 <) (22 10 ^) (21 10 >) (20 10 ^)
    (19 10 ^) (17 10 <) (16 10 <) (15 10 >) (14 10 >) (13 10 >) (12 10 >)
    (11 10 ^) (10 10 <) (9 10 v) (8 10 >) (7 10 v) (6 10 ^) (3 10 ^) (2 10 ^)
    (1 10 >) (120 9 >) (119 9 <) (118 9 v) (117 9 <) (116 9 ^) (114 9 ^) (113 9 <)
    (112 9 ^) (111 9 >) (110 9 ^) (109 9 >) (108 9 ^) (107 9 >) (104 9 <)
    (103 9 >) (102 9 ^) (101 9 >) (100 9 >) (99 9 ^) (98 9 v) (97 9 ^) (96 9 <)
    (95 9 >) (94 9 ^) (93 9 v) (92 9 <) (91 9 >) (90 9 ^) (89 9 <) (88 9 ^)
    (87 9 ^) (86 9 ^) (85 9 <) (84 9 v) (83 9 ^) (82 9 >) (81 9 <) (80 9 <)
    (79 9 ^) (77 9 <) (75 9 ^) (74 9 v) (73 9 ^) (71 9 <) (70 9 ^) (69 9 ^)
    (68 9 v) (67 9 v) (66 9 v) (65 9 <) (64 9 >) (61 9 >) (60 9 ^) (59 9 <)
    (58 9 ^) (57 9 ^) (56 9 >) (55 9 ^) (54 9 ^) (53 9 >) (52 9 >) (51 9 v)
    (50 9 v) (49 9 v) (48 9 v) (46 9 v) (45 9 v) (44 9 ^) (42 9 >) (41 9 <)
    (40 9 v) (39 9 v) (38 9 <) (37 9 v) (36 9 ^) (35 9 v) (34 9 v) (33 9 >)
    (32 9 v) (31 9 v) (30 9 <) (29 9 <) (28 9 <) (27 9 ^) (26 9 <) (25 9 >)
    (24 9 <) (23 9 ^) (22 9 <) (21 9 >) (20 9 >) (19 9 ^) (18 9 v) (17 9 >)
    (16 9 v) (15 9 >) (14 9 >) (13 9 ^) (11 9 >) (10 9 <) (9 9 <) (8 9 >) (7 9 v)
    (6 9 <) (5 9 >) (2 9 >) (1 9 >) (120 8 >) (119 8 ^) (118 8 ^) (117 8 ^)
    (116 8 ^) (115 8 ^) (114 8 ^) (113 8 >) (112 8 v) (111 8 v) (110 8 ^)
    (109 8 >) (108 8 <) (107 8 v) (106 8 >) (105 8 >) (104 8 >) (102 8 ^)
    (101 8 >) (100 8 v) (99 8 ^) (98 8 >) (97 8 v) (96 8 ^) (95 8 >) (94 8 ^)
    (93 8 v) (92 8 ^) (91 8 ^) (90 8 ^) (89 8 <) (88 8 >) (87 8 v) (86 8 <)
    (85 8 <) (83 8 v) (82 8 <) (81 8 <) (80 8 v) (79 8 v) (78 8 >) (77 8 <)
    (76 8 v) (75 8 ^) (73 8 <) (71 8 ^) (70 8 <) (69 8 ^) (68 8 >) (67 8 >)
    (66 8 ^) (65 8 v) (64 8 v) (63 8 >) (62 8 ^) (61 8 <) (60 8 >) (59 8 >)
    (58 8 v) (57 8 >) (55 8 ^) (54 8 <) (53 8 v) (50 8 >) (49 8 >) (48 8 ^)
    (45 8 v) (44 8 ^) (42 8 v) (41 8 <) (40 8 ^) (39 8 ^) (38 8 <) (37 8 ^)
    (36 8 <) (35 8 >) (34 8 >) (32 8 v) (31 8 v) (30 8 <) (28 8 >) (27 8 <)
    (26 8 v) (24 8 v) (23 8 >) (22 8 ^) (21 8 <) (20 8 >) (19 8 v) (18 8 v)
    (17 8 ^) (16 8 >) (15 8 <) (14 8 >) (12 8 v) (11 8 ^) (10 8 <) (9 8 ^) (8 8 <)
    (7 8 ^) (6 8 ^) (5 8 >) (4 8 v) (3 8 <) (2 8 <) (1 8 <) (120 7 <) (119 7 ^)
    (118 7 >) (117 7 <) (116 7 <) (115 7 ^) (114 7 v) (113 7 v) (112 7 v)
    (111 7 <) (110 7 >) (109 7 ^) (107 7 >) (106 7 <) (104 7 >) (103 7 ^)
    (102 7 v) (101 7 >) (100 7 <) (99 7 ^) (98 7 v) (97 7 v) (95 7 >) (94 7 >)
    (93 7 >) (92 7 v) (91 7 >) (90 7 <) (89 7 <) (88 7 ^) (87 7 ^) (86 7 v)
    (85 7 v) (84 7 ^) (83 7 >) (81 7 >) (80 7 v) (79 7 <) (78 7 v) (77 7 ^)
    (76 7 <) (75 7 ^) (74 7 <) (73 7 >) (72 7 v) (70 7 <) (69 7 >) (68 7 ^)
    (67 7 <) (65 7 ^) (64 7 <) (63 7 <) (62 7 v) (61 7 ^) (60 7 >) (59 7 <)
    (58 7 v) (57 7 v) (56 7 v) (55 7 ^) (54 7 <) (53 7 <) (52 7 >) (51 7 >)
    (50 7 v) (47 7 <) (45 7 ^) (44 7 >) (43 7 v) (42 7 >) (41 7 >) (40 7 <)
    (39 7 <) (38 7 ^) (37 7 ^) (36 7 v) (35 7 v) (34 7 v) (33 7 <) (32 7 v)
    (31 7 v) (30 7 <) (29 7 v) (28 7 ^) (27 7 v) (26 7 >) (25 7 <) (24 7 >)
    (23 7 v) (22 7 v) (21 7 ^) (19 7 <) (18 7 <) (17 7 ^) (16 7 v) (15 7 >)
    (14 7 v) (13 7 <) (12 7 >) (11 7 v) (10 7 >) (9 7 ^) (8 7 >) (7 7 v) (6 7 ^)
    (5 7 ^) (4 7 <) (3 7 v) (2 7 <) (1 7 <) (120 6 >) (119 6 v) (117 6 <)
    (116 6 ^) (115 6 ^) (114 6 ^) (113 6 <) (112 6 v) (111 6 <) (110 6 v)
    (109 6 >) (107 6 >) (105 6 v) (104 6 <) (103 6 v) (102 6 v) (101 6 v)
    (100 6 <) (98 6 >) (97 6 >) (96 6 <) (95 6 >) (94 6 ^) (93 6 v) (92 6 <)
    (90 6 v) (89 6 v) (88 6 ^) (87 6 ^) (86 6 ^) (85 6 <) (83 6 v) (82 6 >)
    (81 6 <) (80 6 <) (79 6 v) (78 6 ^) (77 6 <) (76 6 >) (75 6 ^) (73 6 <)
    (72 6 <) (71 6 v) (70 6 >) (69 6 >) (68 6 v) (67 6 >) (66 6 <) (65 6 <)
    (64 6 >) (63 6 v) (61 6 <) (60 6 >) (59 6 >) (58 6 <) (57 6 <) (56 6 v)
    (55 6 ^) (54 6 <) (53 6 v) (52 6 ^) (51 6 v) (50 6 >) (49 6 ^) (48 6 <)
    (46 6 ^) (45 6 ^) (44 6 >) (43 6 >) (42 6 ^) (41 6 ^) (40 6 v) (39 6 v)
    (38 6 v) (37 6 ^) (36 6 v) (35 6 v) (33 6 ^) (32 6 ^) (31 6 v) (30 6 <)
    (29 6 v) (28 6 ^) (26 6 ^) (25 6 ^) (24 6 v) (23 6 <) (22 6 >) (21 6 >)
    (20 6 >) (19 6 ^) (18 6 >) (17 6 ^) (16 6 <) (15 6 <) (14 6 ^) (12 6 ^)
    (11 6 <) (9 6 <) (8 6 v) (7 6 <) (6 6 <) (5 6 v) (4 6 ^) (3 6 ^) (2 6 ^)
    (1 6 <) (120 5 <) (119 5 >) (118 5 ^) (117 5 ^) (116 5 v) (115 5 >) (114 5 ^)
    (112 5 <) (110 5 v) (109 5 <) (108 5 v) (107 5 <) (105 5 v) (102 5 <)
    (100 5 <) (99 5 >) (98 5 v) (97 5 <) (96 5 v) (95 5 <) (94 5 <) (92 5 v)
    (91 5 <) (90 5 ^) (89 5 ^) (88 5 ^) (87 5 <) (86 5 <) (85 5 <) (84 5 <)
    (83 5 <) (82 5 ^) (81 5 >) (80 5 <) (79 5 v) (78 5 >) (77 5 ^) (76 5 v)
    (75 5 <) (73 5 ^) (72 5 v) (71 5 ^) (70 5 >) (69 5 ^) (68 5 v) (67 5 ^)
    (66 5 <) (65 5 v) (64 5 >) (63 5 >) (62 5 <) (61 5 ^) (60 5 <) (59 5 >)
    (58 5 >) (57 5 <) (56 5 >) (55 5 ^) (54 5 <) (52 5 v) (51 5 ^) (50 5 ^)
    (49 5 <) (48 5 ^) (47 5 >) (46 5 >) (45 5 <) (44 5 <) (43 5 <) (42 5 ^)
    (41 5 <) (40 5 ^) (39 5 v) (38 5 <) (37 5 <) (36 5 <) (35 5 <) (34 5 <)
    (33 5 ^) (32 5 v) (31 5 >) (29 5 >) (28 5 >) (26 5 >) (25 5 v) (24 5 >)
    (23 5 >) (22 5 v) (21 5 <) (20 5 v) (18 5 ^) (17 5 ^) (15 5 v) (14 5 <)
    (13 5 ^) (12 5 >) (11 5 v) (10 5 <) (9 5 ^) (8 5 <) (6 5 >) (5 5 v) (4 5 <)
    (3 5 ^) (2 5 >) (1 5 >) (120 4 <) (119 4 v) (118 4 v) (117 4 >) (115 4 ^)
    (114 4 ^) (113 4 >) (111 4 v) (110 4 <) (109 4 v) (108 4 <) (106 4 v)
    (105 4 <) (104 4 ^) (103 4 v) (102 4 v) (101 4 >) (100 4 >) (99 4 v) (98 4 >)
    (97 4 ^) (96 4 ^) (95 4 ^) (94 4 ^) (93 4 >) (92 4 >) (91 4 ^) (90 4 v)
    (89 4 >) (88 4 <) (87 4 <) (86 4 v) (85 4 ^) (84 4 >) (83 4 ^) (82 4 <)
    (81 4 v) (80 4 <) (79 4 <) (78 4 ^) (77 4 <) (76 4 v) (75 4 ^) (74 4 ^)
    (73 4 >) (72 4 v) (69 4 <) (68 4 >) (66 4 <) (65 4 >) (64 4 ^) (63 4 <)
    (62 4 <) (61 4 <) (60 4 >) (59 4 ^) (58 4 v) (56 4 <) (55 4 >) (54 4 v)
    (53 4 <) (52 4 v) (51 4 <) (50 4 <) (49 4 <) (48 4 <) (47 4 v) (46 4 <)
    (45 4 ^) (44 4 v) (43 4 ^) (42 4 >) (41 4 ^) (40 4 <) (39 4 v) (38 4 ^)
    (36 4 v) (35 4 <) (34 4 <) (33 4 v) (32 4 <) (31 4 <) (30 4 ^) (29 4 ^)
    (28 4 ^) (27 4 <) (26 4 v) (25 4 >) (24 4 ^) (23 4 <) (22 4 ^) (21 4 ^)
    (20 4 v) (19 4 v) (18 4 >) (17 4 v) (16 4 <) (15 4 <) (14 4 <) (13 4 <)
    (12 4 >) (10 4 ^) (9 4 >) (7 4 <) (6 4 v) (5 4 ^) (4 4 v) (3 4 <) (2 4 v)
    (1 4 >) (120 3 <) (119 3 ^) (118 3 >) (116 3 <) (115 3 >) (114 3 v) (113 3 ^)
    (112 3 v) (111 3 v) (110 3 >) (109 3 <) (108 3 <) (107 3 >) (106 3 >)
    (105 3 <) (104 3 v) (103 3 ^) (102 3 v) (101 3 v) (99 3 >) (98 3 ^) (97 3 >)
    (96 3 <) (95 3 >) (93 3 v) (92 3 v) (91 3 <) (90 3 ^) (89 3 ^) (88 3 <)
    (87 3 v) (86 3 ^) (85 3 v) (84 3 v) (82 3 v) (81 3 v) (80 3 >) (79 3 ^)
    (78 3 <) (77 3 v) (75 3 >) (74 3 >) (73 3 <) (72 3 <) (71 3 <) (70 3 >)
    (69 3 >) (68 3 ^) (67 3 <) (66 3 ^) (65 3 v) (64 3 <) (63 3 v) (62 3 ^)
    (61 3 <) (60 3 v) (59 3 v) (58 3 <) (57 3 v) (56 3 >) (55 3 <) (54 3 <)
    (53 3 >) (52 3 >) (51 3 <) (50 3 v) (49 3 ^) (48 3 >) (47 3 v) (46 3 >)
    (45 3 >) (44 3 v) (43 3 ^) (42 3 >) (41 3 v) (40 3 <) (39 3 ^) (37 3 ^)
    (36 3 v) (35 3 v) (34 3 v) (32 3 >) (31 3 <) (30 3 >) (29 3 v) (28 3 ^)
    (27 3 <) (26 3 <) (24 3 ^) (23 3 <) (22 3 <) (21 3 <) (20 3 ^) (19 3 v)
    (18 3 ^) (17 3 ^) (16 3 v) (15 3 ^) (14 3 <) (13 3 <) (12 3 ^) (11 3 >)
    (10 3 <) (9 3 <) (8 3 ^) (7 3 ^) (6 3 >) (5 3 ^) (4 3 <) (3 3 ^) (2 3 >)
    (1 3 >) (120 2 >) (119 2 v) (118 2 >) (117 2 <) (116 2 <) (115 2 >) (113 2 >)
    (112 2 <) (111 2 >) (110 2 >) (109 2 ^) (108 2 >) (107 2 >) (106 2 v)
    (105 2 <) (103 2 ^) (101 2 <) (100 2 <) (99 2 ^) (98 2 ^) (97 2 ^) (96 2 v)
    (95 2 ^) (94 2 ^) (93 2 v) (92 2 >) (91 2 >) (90 2 <) (88 2 ^) (87 2 >)
    (86 2 v) (85 2 >) (84 2 >) (83 2 >) (82 2 ^) (81 2 v) (80 2 <) (79 2 ^)
    (78 2 ^) (77 2 >) (76 2 <) (75 2 >) (73 2 >) (72 2 ^) (71 2 v) (70 2 ^)
    (68 2 >) (67 2 >) (66 2 >) (65 2 v) (64 2 <) (63 2 >) (62 2 <) (61 2 ^)
    (60 2 <) (59 2 >) (58 2 >) (57 2 <) (56 2 ^) (55 2 >) (54 2 >) (52 2 ^)
    (51 2 v) (50 2 >) (49 2 >) (48 2 >) (47 2 v) (46 2 v) (45 2 <) (44 2 >)
    (43 2 v) (42 2 v) (41 2 ^) (40 2 v) (39 2 <) (38 2 <) (37 2 <) (36 2 v)
    (35 2 <) (34 2 >) (33 2 v) (32 2 v) (31 2 v) (30 2 <) (29 2 ^) (28 2 v)
    (27 2 ^) (26 2 >) (25 2 <) (24 2 <) (23 2 ^) (22 2 >) (21 2 <) (20 2 >)
    (18 2 >) (17 2 v) (16 2 <) (15 2 v) (14 2 ^) (12 2 <) (11 2 <) (9 2 <) (8 2 >)
    (7 2 ^) (6 2 v) (5 2 ^) (4 2 ^) (3 2 v) (2 2 >) (1 2 >) (119 1 <) (118 1 v)
    (117 1 ^) (116 1 v) (115 1 ^) (114 1 v) (113 1 <) (112 1 v) (111 1 <)
    (110 1 ^) (109 1 ^) (108 1 >) (107 1 <) (106 1 <) (105 1 v) (104 1 ^)
    (101 1 ^) (100 1 >) (98 1 >) (97 1 v) (96 1 v) (95 1 ^) (93 1 v) (92 1 v)
    (91 1 ^) (90 1 >) (89 1 >) (88 1 v) (87 1 <) (86 1 <) (85 1 v) (84 1 v)
    (83 1 v) (82 1 <) (81 1 v) (79 1 <) (78 1 v) (77 1 <) (76 1 ^) (75 1 v)
    (74 1 >) (73 1 <) (72 1 v) (71 1 <) (70 1 <) (69 1 ^) (68 1 v) (67 1 v)
    (66 1 >) (65 1 >) (64 1 v) (63 1 ^) (62 1 ^) (61 1 v) (60 1 >) (59 1 v)
    (58 1 >) (57 1 <) (56 1 >) (55 1 v) (53 1 v) (52 1 ^) (51 1 ^) (50 1 >)
    (49 1 >) (48 1 v) (47 1 >) (46 1 v) (45 1 >) (44 1 <) (43 1 <) (42 1 v)
    (41 1 <) (40 1 >) (39 1 <) (38 1 <) (35 1 >) (34 1 >) (33 1 <) (32 1 v)
    (31 1 ^) (30 1 >) (29 1 >) (28 1 ^) (27 1 <) (26 1 v) (25 1 ^) (24 1 >)
    (23 1 v) (22 1 >) (21 1 <) (20 1 >) (19 1 >) (18 1 <) (17 1 ^) (16 1 >)
    (15 1 >) (14 1 >) (13 1 <) (12 1 ^) (11 1 <) (10 1 >) (9 1 <) (8 1 ^) (7 1 v)
    (6 1 >) (5 1 ^) (3 1 ^) (2 1 <) (1 1 >)))


;; C-c C-t (un)trace
(defun fib (n)
  (cond
    ((< n 2) 1) ;;(fib (/ n 0)))
    (t ;;(break)
       (+ (fib (- n 2)) (fib (- n 1))))))



#|

explorer at (1 0)
target destination is (width (+ 1 height))

am i in the wall ?
have i reached the destination ?
have i collided with a blizzard

proceed will take a list of positions and list of winds
for each wind , it will look through list of positions and if that position is
hit by a blizzard remove it
if that position is in the wall , remove it
if that position is the end destination , declare a winner and stop
otherwise move onto next wind , with current list of positions

be aware of side effects

|#


;; check remove is functional , no side effects
(let ((xs '((1 2)(3 4))))
  (let ((ys (remove '(1 2) xs :test #'equalp)))
    (format t  "xs = ~a~%" xs)
    (format t  "ys = ~a~%" ys)
    (assert (equalp xs `((1 2)(3 4))))
    ))


(defun filter (xs fn)
  (let ((result (list)))
    (loop for x in xs do
      (when (funcall fn x)
	;;(format t  "x = ~a~%" x)
	(setq result (cons x result))))
    (nreverse result)))

(assert (equalp (filter '(1 2 3 4 5 6 7 8 9 10) #'oddp) (list 1 3 5 7 9)))
(assert (equalp (filter '(1 2 3 4 5 6 7 8 9 10) (lambda (x)(oddp x))) (list 1 3 5 7 9)))



;; in-the-wall , but in-playfield better name and keeps it in list to be considered
;; because macro we need to call it like a procedure (%-in-playfield-%)
;; we have access to width and height at call site , why we need it to be a macro
;; also compresses search algorithm routine so we can easily see whats going on
(defun in-play(&key position width height)
  (destructuring-bind (x y) position
    (cond
      ((and (= x 1)(= y 0)) t)
      ((and (= x width)(= y (+ 1 height))) t)
      ((<= x 0) nil)
      ((>= x (+ width 1)) nil)
      ((<= y 0) nil)
      ((>= y (+ height 1)) nil)
      (t t))))

;; tests
;; when we compile the file , if assertion failure , press v to sldb-view source
;; emacs takes me to what assertion failed , nice
;; choose arbitrary width height , something cover all cases , not too large to slow anything
(let ((width 5)(height 5))
  ;; a simple test example to get head around idea
  (assert (eq t (in-play :position '(1 1) :width 5 :height 5)))
  ;; entry point valid 
  (assert (eq t (in-play :position '(1 0) :width width :height height)))
  ;; exit point valid
  (assert (eq t (in-play :position (list width (+ height 1)) :width width :height height)))
  ;; on playfield valid
  (loop for x from 1 to width do
    (loop for y from 1 to height do
      (assert (eq t (in-play :position (list x y) :width width :height height)))))
  ;; top edge invalid except 1 0 
  ;; bottom edge invalid except width (+ height 1) 
  (loop for x from (- (* width 2)) to (+ (* width 2)) do
    (let ((y 0))
      (when (not (and (= x 1)(= y 0)))	
	(assert (eq nil (in-play :position (list x y) :width width :height height)))))
    (let ((y (+ height 1)))
      (when (not (and (= x width)(= y (+ height 1))))	
	(assert (eq nil (in-play :position (list x y) :width width :height height))))))
  ;; left edge invalid
  (loop for y from (- (* height 2)) to (* height 2) do
    (loop for x from (- (* width 2)) to (* width 2) do
      (when (not (or
		  (and (= x 1)(= y 0))
		  (and (= x width)(= y (+ height 1)))
		  (and (>= x 1)(<= x width)(>= y 1)(<= y height))))
	(assert (eq nil (in-play :position (list x y) :width width :height height)))))))

  
;; given a list of positions - remove any of those that are not in-play
(defun in-play-positions (&key positions width height)
  (remove-if-not (lambda (v) (in-play :position v :width width :height height))
		 positions))

;; test in-play-positions correctly removes any should not be allowed in play
(let ((positions '((502 303)
		   (1 0) ;; entry
		   (5 6) ;; exit
		   (0 1)(0 2)(0 3) ;; out of play
		   (1 10)(2 10)(3 10) ;; out of play
		   (607 912) ;; way out of play
		   (2 3) ;; some in play
		   (4 5) 
		   ))
      (width 5)
      (height 5))
  (assert (equalp (in-play-positions :positions positions :width width :height height)
		  `((1 0) (5 6) (2 3) (4 5)))))


(defun avoid-blizzards (&key positions winds)
  (let ((result '()))
    (loop for position in positions do
      (destructuring-bind (x y) position
	(catch 'bliz
	  (loop for wind in winds do
	    (destructuring-bind (wx wy wdir) wind
	      (cond
		((and (= x wx)(= y wy)) ;; discard position
		 (throw 'bliz nil)))))
	  ;; no blizzard conflict - keep position
	  (setq result (cons position result)))))
    result))


(let ((positions '((1 0)(2 3)(4 5)))
      (winds (cdr (cdr *example1*))))
  (avoid-blizzards :positions positions :winds winds))
;;=> ((4 5) (2 3) (1 0))

;; remove duplicate positions 
;; we could of combined all procedures together , but make them more complex
;; initial correctness and testing we split them and make them as simple as possible




#|
    
;; unit tests 

;;(loop for x in '(1 2 3) do (format t "x= ~a~%" x))
(defmacro %-no-bliz ()
  `(progn
     (loop for wind in winds do
       (destructuring-bind (wx wy wdir) wind
	 (setq p (filter p (lambda (pos)
			     (destructuring-bind (x y) pos
			       (not (and (= x wx)(= y wy)))))))))
     p))


;; p : positions -> in-play -> no-bliz -> in-play + no-bliz
(defun proceed-temp2 (p winds width height)
  (let* ((p (filter p (%-in-play)))
	 (p2 (progn (%-no-bliz))))
    p2))


(defun proceed-test2 ()
  (let* ((input *example1*)
	 (winds (cdr (cdr input)))
	 (width (car (car input)))
	 (height (car (cdr (car input)))))
    (proceed-temp2 '((502 303) (1 0)) winds width height)))

#|
for each position , have it move up down left right
this generate a new list of positions we can go
if we have a 2d grid width height and mark where we can go
record this position if it is not already marked

can go up down left right and also wait

if want debuggable code need to be able to call code with everything it needs to
compute the result
- in general a lot of information
- need some sort of hash map to pass to
- or optional and default and named arguments
either way , sufficiently more complex than a simple fibonacci call

|#

(defmacro %-all-directions ()
  `(progn
     (let ((grid (make-array (list (+ width 4) (+ height 4)) :initial-element nil))
	   (new-positions nil))
       (format t "created grid size ~a ~%" (array-dimensions grid))
       (loop for p in p2 do ;; for each position in positions do			    
        (destructuring-bind (x y) p
	  (format t "looking at positon ~a <= ~a ~a~% " p x y)
	 (let ((x2 x)(y2 (- y 1))) ;; GO UP 
	   (when (and (>= x 0)(>= y 0)(<= x (+ width 1))(<= y (+ height 1))) ;; in grid
	     (let ((ge (aref grid x2 y2)))
	       (when (not ge) (setf (aref grid x2 y2) t)
		     (setq new-positions (cons (list x2 y2) new-positions))))))

	  
	 ;; (let ((x2 x)(y2 (+ y 1))) ;; GO DOWN 
	 ;;   (when (and (>= x2 0)(>= y2 0)(<= x2 (+ width 1))(<= y2 (+ height 1))) ;; in grid
	 ;;     (let ((ge (aref grid x2 y2)))
	 ;;       (when (not ge) (setf (aref grid x2 y2) t)
	 ;; 	     (setq new-positions (cons (list x2 y2) new-positions))))))
	 ;; (let ((x2 (- x 1))(y2 y)) ;; GO LEFT
	 ;;   (when (and (>= x2 0)(>= y2 0)(<= x2 (+ width 1))(<= y2 (+ height 1))) ;; in grid
	 ;;     (let ((ge (aref grid x2 y2)))
	 ;;       (when (not ge) (setf (aref grid x2 y2) t)
	 ;; 	     (setq new-positions (cons (list x2 y2) new-positions))))))
	 ;; (let ((x2 (+ x 1))(y2 y)) ;; GO RIGHT
	 ;;   (when (and (>= x2 0)(>= y2 0)(<= x2 (+ width 1))(<= y2 (+ height 1))) ;; in grid
	 ;;     (let ((ge (aref grid x2 y2)))
	 ;;       (when (not ge) (setf (aref grid x2 y2) t)
	 ;; 	     (setq new-positions (cons (list x2 y2) new-positions))))))
	 ;; (let ((x2 x)(y2 y)) ;; STAY STILL
	 ;;   (when (and (>= x2 0)(>= y2 0)(<= x2 (+ width 1))(<= y2 (+ height 1))) ;; in grid
	 ;;     (let ((ge (aref grid x2 y2)))
	 ;;       (when (not ge) (setf (aref grid x2 y2) t)
	 ;; 	     (setq new-positions (cons (list x2 y2) new-positions))))))
	  
	  ))
       new-positions)))
	 

(defun proceed-temp3 (p winds width height)
  (let* ((p (filter p (%-in-play)))
	 (p2 (progn (%-no-bliz)))
	 (p3 (progn (break)(%-all-directions))))
    p3))

(defun proceed-test3 ()
  (let* ((input *example1*)
	 (winds (cdr (cdr input)))
	 (width (car (car input)))
	 (height (car (cdr (car input)))))
    (proceed-temp3 '((502 303) (1 0)) winds width height)))


|#












